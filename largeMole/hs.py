#!/usr/bin/env python

from pyscf import scf
from pyscf import gto,dft

mol = gto.Mole()
mol.verbose = 6
mol.output = 'hs.out'
mol.atom = '''
  Mo  7.34411020207581      1.17495097908005      6.72284263905920
  Fe  7.84036274632279      2.40948832380662      3.90857987198295
  S   8.11413397508734      3.34683967317511      5.92473122721237
  Cl  9.42237962692288      2.83901882053830      2.40523971787167
  S   7.63129189448338      0.24683725427736      4.48256715460659
  Cl  5.78420653505383      3.15381896731458      3.13969003482939
  N   7.05276738605521      2.42445066370842      8.66076404425459
  N   6.64167403727998     -1.00707407196440      7.11600799320614
  N   5.24002742536262      1.70306900993116      5.97156233521481
  H   6.27407522563538      2.37009344884271      9.32021452836747
  H   7.93656914286549      2.22405698642280      9.14675757456406
  H   7.12313637861828      3.37423478174186      8.26848891472229
  H   4.53157107313027      2.02429015953190      6.63557341863725
  H   5.36325579034589      2.43796505637839      5.24458486826946
  H   4.86812692298093      0.90155604764634      5.45231738540969
  H   5.82209673287966     -1.30027608533573      7.65147593202357
  H   6.56861368828978     -1.33871396574670      6.14286445056596
  H   7.48831993436433     -1.42577562013418      7.51985443522153
  S   9.40594188780477      0.42545761808747      7.87277304102829
  H   8.82966334944139     -0.10099345030206      8.99111747895267
'''
mol.basis = 'tzp-dkh'
mol.charge = -1
mol.spin = 8
mol.build()

#mf = scf.sfx2c(scf.UHF(mol))
#mf.chkfile = 'hs.chk'
#mf.max_cycle = 500
#mf.level_shift_factor=0.1
#mf.conv_tol = 1.e-2
#mf.scf()
#
#mf2 = scf.newton(mf)
##mf2.ah_start_tol = 1.e-8
##mf2.ah_conv_tol = 1.e-14
#mf2.conv_tol = 1.e-12
#mf2.kernel()

mf = scf.sfx2c(scf.UHF(mol))
mf.chkfile = 'hs.chk'
mf.max_cycle = 500
mf.level_shift_factor=0.0
mf.scf()

mc = mcscf.CASSCF(mf, 12, 12)
mc.chkfile = 'mc.chk'
cas_occ = {'A1g':2, 'A1u':2,'E1ux':1, 'E1uy':1,'E1gx':1, 'E1gy':1, 'E2ux': 1, 'E2uy': 1, 'E2gx': 1, 'E2gy': 1}
caslst =  mcscf.addons.select_mo_by_irrep(mc,cas_occ)
list.sort(caslst)
mo = mcscf.addons.sort_mo(mc, m.mo_coeff, caslst, 1)
mc.mc1step(mo)

sc_nevpt(mc)
